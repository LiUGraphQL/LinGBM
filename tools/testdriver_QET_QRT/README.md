# Test Driver <br/> of the Link√∂ping GraphQL Benchmark (LinGBM)

This directory contains the test driver program of the benchmark, which is developed for testing execution time and response time of single query.

The required input for this test driver is the path to directory of actual queries that are generated by querygen tool. 


### Setup
Before starting the test driver, you need to first start up the GraphQL server, and generate the queries with the [querygen](https://github.com/LiUGraphQL/LinGBM/tree/master/tools/querygen).
Then, you could build up the test driver using the following command:

```
git clone git@github.com:LiUGraphQL/LinGBM.git
cd LinGBM/tools/testdriver_QET_QRT/
npm install
yarn run build
```

### Usage

Option '-n' can be used to specify the number of queries per template that would like to test. For instance, to capture the execution time of 5 queries per template, you can use the following example command:
```
yarn start -a ACTUALQUERIES_PATH -n 5
```
The ACTUALQUERIES_PATH needs to be the path where the generated queries are. This tool will then synchronously load all generated queries and run them one by one. By default, this tool captures execution time and response time (in millisecond) of 10 queries per templates. Result of all tested queries are recorded into a csv file under directory `./output/`. The result contains five columns **{"Query Template", "Query Index", "Execution time(ms)", "Response time(ms)", "Error"}**

If you need to capture the query time of some instance for a specific query template, then the option '-q <queryTP>' can be used for setting the query template. For example, the following command is for capturing execution time of 10 quries for query template 1
```
yarn start -a ACTUALQUERIES_PATH -q 1
```

In addition, there are also some other arguments that can be used to change configurations of the test driver:
| Argument | Description |
| ------ | ------|
|-a, --actual-queries \<path>|Path to actualQueries folder| 
|-s --server \<url> |complete URL to the GraphQL server under test, including port (if any) and local path (if any). Default: "http://localhost:4000" |
|-o --name \<name> |Set the name of the output file |
|-q, --queryTP \<queryTP> |Set the queryTemplate to test|
|-n, --numberQET \<numberQET> |Specify the number of queries per template that are used to test execution time. Default: 10|