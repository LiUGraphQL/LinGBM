# Test Driver <br/> of the Link√∂ping GraphQL Benchmark (LinGBM)

This directory contains the test driver program of the benchmark, which is developed for testing execution time of single query.

The required input for the test driver is the path to the actual queries directory generated by the querygen tool. 


### Setup
Before starting the test driver, you have to first start up the GraphQL server, and generate the queries with the [querygen](https://github.com/LiUGraphQL/LinGBM/tree/master/tools/querygen).
Then, you could build up the test driver using the following command:

```
git clone git@github.com:LiUGraphQL/LinGBM.git
cd LinGBM/tools/testdriver/
npm install update
yarn run build
```

### Usage

To capture the execution time of 5 queries per template, please use the following example command:
```
yarn start -a ACTUALQUERIES_PATH -n 5
```
The ACTUALQUERIES_PATH needs to be the path where the generated queries are. This tool will then synchronously load all the generated queries and run them one by one. By default, this tool captures the execution time of 10 queries per templates and writes the execution time of single query into a csv file under the directory `./output/`, with four columns {"Query Template", "Query Index", "Execution time", "Response time", "Error"}

If you need to capture the execution time of some instance for a specific query template, then the option '-q <queryTP>' can be used for setting the query template. For example, the following command is for capturing execution time of 10 quries for query template 1
```
yarn start -a ACTUALQUERIES_PATH -q 1
```

In addition, there are also some other arguments can be used to change the configuration of the test driver:
| Argument | Description |
| ------ | ------|
|-a, --actual-queries \<path>|Path to actualQueries folder| 
|-s --server <url> |URL to the GraphQL server to test. Default: localhost |
|-p --port <port> |Port used by the GraphQL server. Default: "4000"|
|-t --type <type> |Type of test to run, et (execution time). et |
|-o --name <name> |Set the name of the output file |
|-q, --queryTP <queryTP> |Set the queryTemplate to test|
|-n, --numberQET <numberQET> |Specify the number of queries per template that are used to test execution time. Default: 10|
